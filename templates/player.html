<!DOCTYPE html>
<html>
<head>
	<!-- Site stuff -->
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1" />

	<!-- Page stuff -->
	<title>@@title</title>
	<meta name="description" content="@@description" />
	<meta name="keywords" content="@@keywords" />
	<link rel="canonical" href="@@url/player/" />

	<!-- Facebook stuff -->
	<meta property="og:site_name" content="@@title" />
	<meta property="og:type" content="website" />
	<meta property="og:title" content="@@title" />
	<meta property="og:url" content="@@url" />
	<meta property="og:description" content="@@description" />
	<meta property="og:locale" content="en_US" />

	<!-- Twitter stuff -->
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:site" content="@@twitterSite" />
	<meta name="twitter:creator" content="@@twitterCreator">
	<meta name="twitter:title" content="@@title" />
	<meta name="twitter:description" content="@@description" />

	<!-- JSON-LD stuff -->
	<script type="application/ld+json">
		@@jsonLd
	</script>

	<!-- Style stuff -->
	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
	<!-- inject:css --><!-- endinject -->

	<!-- Import stuff -->
	<link rel="import" href="@@vendorUrl/google-youtube/google-youtube.html" />
	<link rel="import" href="{{ url_for('static', filename='components/tweet-list.html') }}" />
</head>
<body>
	<header>
		<h1><a href="/">Rechorus</a></h1>
		<nav>
			<ul>
				<li><a href="#">Item 1</a></li>
				<li><a href="#">Item 2</a></li>
				<li><a href="#">Item 3</a></li>
				<li><a href="#">Item 4</a></li>
			</ul>
		</nav>
	</header>

	<div class="wrapper">
		<section id="media" tabindex="0">
			<google-youtube
				id="player"
				width="1280px"
				height="720px"
				fluid="1"
				autoplay="0"
				disablekb="1"
				chromeless="1"
				video-id="{{ video_id }}">
			</google-youtube>
			<div class="controls">
				<button class="plause" type="button" data-state="pause">Play/Pause</button>
				<div class="progress">
					<progress></progress>
					<div class="track">
						<span class="label">0:00</span>
					</div>
				</div>
			</div>
			<div class="loader">
				Loading...
				<svg class="thumper" x="0px" y="0px" viewBox="0 0 256 256" style="enable-background:new 0 0 256 256;" xml:space="preserve">
					<path class="svgpath" d="M189.5,140.5c-6.6,29.1-32.6,50.9-63.7,50.9c-36.1,0-65.3-29.3-65.3-65.3 c0,0,17,0,23.5,0c10.4,0,6.6-45.9,11-46c5.2-0.1,3.6,94.8,7.4,94.8c4.1,0,4.1-92.9,8.2-92.9c4.1,0,4.1,83,8.1,83 c4.1,0,4.1-73.6,8.1-73.6c4.1,0,4.1,63.9,8.1,63.9c4.1,0,4.1-53.9,8.1-53.9c4.1,0,4.1,44.1,8.2,44.1c4.1,0,3.1-34.5,7.2-34.5 c4.1,0,3.1,24.6,7.2,24.6c4.1,0,2.5-14.5,5.2-14.5c2.2,0,0.8,5.1,4.2,4.9c0.4,0,13.1,0,13.1,0c0-34.4-27.9-62.3-62.3-62.3 c-27.4,0-50.7,17.7-59,42.3" />
					<path class="svgbg" d="M61,126c0,0,16.4,0,23,0c10.4,0,6.6-45.9,11-46c5.2-0.1,3.6,94.8,7.4,94.8c4.1,0,4.1-92.9,8.2-92.9 c4.1,0,4.1,83,8.1,83c4.1,0,4.1-73.6,8.1-73.6c4.1,0,4.1,63.9,8.1,63.9c4.1,0,4.1-53.9,8.1-53.9c4.1,0,4.1,44.1,8.2,44.1 c4.1,0,3.1-34.5,7.2-34.5c4.1,0,3.1,24.6,7.2,24.6c4.1,0,2.5-14.5,5.2-14.5c2.2,0,0.8,5.1,4.2,4.9c0.4,0,22.5,0,23,0" />
				</svg>
			</div>
		</section>

		<tweet-list id="tweets"></tweet-list>
	</div>

	<script src="@@vendorUrl/webcomponentsjs/webcomponents.min.js"></script>
	<script src="@@vendorUrl/d3/d3.min.js"></script>
	<!-- inject:js --><!-- endinject -->

	<script>
		var tt,
			media = document.querySelector('#media'),
			player = document.querySelector('#player'),
			mp = new MediaPlayer(media, player, {
				onPlayerReady: function(videoId, duration) {
					console.log('CALLBACK', videoId, duration);
					tt = new TweetTracker(document.querySelector('#tweets'), {
						duration: duration,
						start: '{{ start_str }}',
						onLoadTweets: function(tweets, minutes) {
							mp.createGraph(tt.morphMinutes(minutes));
							mp.toggleLoader(false);
							mp.play();
						},
					});
					tt.loadTweets();
				},
				onUpdateTime: function(currentTime) {
					if (tt !== undefined) {
						tt.updateTime(currentTime);
					}
				},
			});
	</script>
</body>
</html>
